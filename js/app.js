!function(e){function t(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var o={};t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var r in e)t.d(n,r,function(t){return e[t]}.bind(null,r));return n},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="./",t(t.s=0)}([function(){var e,t,o,n,r=Math.ceil,i=!0,a=[],c=[],l=!1,s="",f=0,u=null,d=15,p=!1;$(window).load((function(){function e(){g.polygon.drawPolygon()}function o(){for(;0<t.getActiveObjects().length;)t.remove(t.getActiveObject()),t.remove(t.getActiveObjects()[0])}function n(){s=window.prompt("Input an area label prefix (e.g. 'A'):")}function r(){f=parseInt(window.prompt("Input a value to incrementate by (e.g. '1' or '-1'):")),u=parseInt(window.prompt("Input an integer start value (e.g. '5'):"))}g.initCanvas(),$("#urlField").change((function(){fabric.Image.fromURL($("#urlField").val(),(function(e){t.setWidth(e.width),t.setHeight(e.height),t.setBackgroundImage(e,t.renderAll.bind(t),{})}))})),$("html").keydown((function(t){46===t.keyCode||8===t.keyCode?o():78===t.keyCode?e():80===t.keyCode?n():73===t.keyCode?r():16===t.keyCode&&(p=!0)})),$("html").keyup((function(e){16===e.keyCode&&(p=!1)})),$("#new").click((function(){e()})),$("#set-prefix").click((function(){n()})),$("#set-increment").click((function(){r()})),$("#export").click((function(){!function(){for(var e={mapRegions:[]},o=t.toJSON().objects,n=0;n<o.length;n++)e.mapRegions.push({area:"",points:[]}),o[n].objects[0].points.forEach((function(t){e.mapRegions[n].points.push([t.x,t.y])})),e.mapRegions[n].area=o[n].objects[1].text;window.prompt("Copy this to your clipboard",JSON.stringify(e))}()}))}));var g=new function(){this.initCanvas=function(){(t=window._canvas=new fabric.Canvas("c")).selection=!1,t.on("mouse:down",(function(e){e.target&&e.target.id==a[0].id&&g.polygon.generatePolygon(a),i&&g.polygon.addPoint(e)})),t.on("mouse:move",(function(i){var c=t.getPointer(i.e);if(1==p?(o=r(c.x/d)*d,n=r(c.y/d)*d):(o=c.x,n=c.y),e&&"line"==e.class){e.set({x2:o,y2:n});var s=l.get("points");s[a.length]={x:o,y:n},l.set({points:s}),t.renderAll()}t.renderAll()})),t.on("object:moving",(function(e){var t=Math.round;1==p&&e.target.set({left:t(e.target.left/d)*d,top:t(e.target.top/d)*d})})),t.on("mouse:wheel",(function(e){var o=e.e.deltaY,n=t.getZoom();20<(n*=Math.pow(.999,o))&&(n=20),.01>n&&(n=.01),t.setZoom(n),e.e.preventDefault(),e.e.stopPropagation()}))}};g.polygon={drawPolygon:function(){i=!0,a=[],c=[]},addPoint:function(i){var s=t.getPointer(i.e);1==p?(o=r(i.e.layerX/d)*d,n=r(i.e.layerY/d)*d):(o=s.x,n=s.y);var f=Math.floor(999901*Math.random())+99,u=(new Date).getTime()+f,g=new fabric.Circle({radius:5,fill:"#ffffff",stroke:"#333333",strokeWidth:.5,left:o/t.getZoom(),top:n/t.getZoom(),selectable:!1,hasBorders:!1,hasControls:!1,originX:"center",originY:"center",id:u,objectCaching:!1});0==a.length&&g.set({fill:"red"});var h=[o/t.getZoom(),n/t.getZoom(),o/t.getZoom(),n/t.getZoom()],y=new fabric.Line(h,{strokeWidth:2,fill:"#999999",stroke:"#999999",class:"line",originX:"center",originY:"center",selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});if(l){(h=l.get("points")).push({x:o,y:n});var m=new fabric.Polygon(h,{stroke:"#333333",strokeWidth:1,fill:"#cccccc",opacity:.3,selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});t.remove(l),t.add(m),l=m,t.renderAll()}else{var v=[{x:o/t.getZoom(),y:n/t.getZoom()}];m=new fabric.Polygon(v,{stroke:"#337ab7",strokeWidth:2,fill:"#337ab7",opacity:.4,selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});l=m,t.add(m)}e=y,a.push(g),c.push(y),t.add(y),t.add(g),t.selection=!1},generatePolygon:function(o){var n=[];$.each(o,(function(e,o){n.push({x:o.left,y:o.top}),t.remove(o)})),$.each(c,(function(e,o){t.remove(o)})),t.remove(l).remove(e);var r,a=new fabric.Polygon(n,{stroke:"#337ab7",strokeWidth:2,fill:"#337ab760",opacity:1,hasBorders:!0,hasControls:!0});0===f?r=s+window.prompt("What area is this?"):(r=s+u,u+=parseInt(f));var d=new fabric.Text(r,{left:a.left+a.width/2,top:a.top+a.height/2}),p=new fabric.Group([a,d],{});t.add(p),e=null,l=null,i=!1,t.selection=!0}}}]);
//# sourceMappingURL=app.js.map